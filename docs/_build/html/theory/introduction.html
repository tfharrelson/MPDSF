

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Theory: Introduction &mdash; MPDSF 0.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Theory: Contact Interactions" href="contactinteraction.html" />
    <link rel="prev" title="Input Directives" href="../usage/inputdirectives.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MPDSF
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/inputdirectives.html">Input Directives</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Theory: Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="contactinteraction.html">Theory: Contact Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="anharmonicinteraction.html">Theory: Anharmonic Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/lowqscaling.html">Features: Including low-q scaling behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/darkphoton.html">Features: Dark photon mediated scattering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/scalarmediator.html">Features: Scalar mediator scattering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/reach.html">Features: Plotting Reach Curves</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MPDSF</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Theory: Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/theory/introduction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theory-introduction">
<h1>Theory: Introduction<a class="headerlink" href="#theory-introduction" title="Permalink to this headline">Â¶</a></h1>
<p>The goal of computing a dynamic structure factor is to evaluate the following function:</p>
<p><span class="math notranslate nohighlight">\(S(\textbf{q}, \omega) = \frac{1}{N} \sum_f \left| \sum_{l}^N \sum_\tau^n \langle \Phi_f | e^{i\textbf{q}\cdot \textbf{r}_{l\tau}} | 0\rangle \right|^2 \delta(E_f - \omega)\)</span></p>
<p>in which <span class="math notranslate nohighlight">\(N\)</span> is the number of supercells (indexed by <span class="math notranslate nohighlight">\(l\)</span>), <span class="math notranslate nohighlight">\(\tau\)</span> is the atomic indices, <span class="math notranslate nohighlight">\(\Phi_f\)</span> is the final state wavefunction after the scattering event, <span class="math notranslate nohighlight">\(\textbf{q}\)</span> is the momentum of the scattering event, <span class="math notranslate nohighlight">\(\textbf{r}_{l\tau}\)</span> is the position operator of atom <span class="math notranslate nohighlight">\(\tau\)</span> in supercell <span class="math notranslate nohighlight">\(l\)</span>, <span class="math notranslate nohighlight">\(E_f\)</span> is the final state energy, and <span class="math notranslate nohighlight">\(\omega\)</span> is the frequency/energy transfer from the scatttering event. This equation implicitly assumes that the initial state is in the vacuum ground state with no phonons present, so the initial energy is set to 0 and ignored. The final state is assumed to be some multi-phonon state comprised of the phonons calculated from the harmonic approximation in Phono3py. This multi-phonon state can be visualized as a vector/string of occupation numbers, in which the index of the vector corresponds to a specific <span class="math notranslate nohighlight">\(s,\textbf{k}\)</span> combination; e.g. <span class="math notranslate nohighlight">\(|\Phi_f\rangle = |001000\rangle\)</span> for the case in which we are only considered one <span class="math notranslate nohighlight">\(\textbf{k}\)</span> value (usually the Gamma point), and there are 6 phonon branches/<span class="math notranslate nohighlight">\(s\)</span> indices, which is true for a diatomic unit cell. In that example, there is one phonon in the third phonon branch, and zero phonons elsewhere in the manifold. To compute the matrix elements of the above operator, expand the position operator into:</p>
<p><span class="math notranslate nohighlight">\(\textbf{r}_{l\tau}= \textbf{R}_l + \textbf{r}_\tau^\circ + \textbf{u}_\tau\)</span></p>
<p>which splits the contributions to the position operator into the lattice vector position, the average position of the atom in the unit cell, and the deviation of the atomic position due to the motion of the atoms. The <span class="math notranslate nohighlight">\(u\)</span> term is the only dynamical variable here, the others are constant vectors which do not change the state function. In the harmonic limit, one can express the <span class="math notranslate nohighlight">\(\textbf{u}\)</span> operator in terms of raising and lowering operators via:</p>
<p><span class="math notranslate nohighlight">\(\textbf{u}_{l\tau} = \frac{1}{\sqrt{N}} \sum_{s,\textbf{k}} \sqrt{\frac{\hbar}{2m_\tau\omega}}(\hat{a}_{s\textbf{k}} + \hat{a}_{s-\textbf{k}}^{\dagger}) \boldsymbol{\epsilon}_{\tau,s\textbf{k}} e^{i\textbf{k}\cdot\textbf{R}_l}\)</span></p>
<p>where the raising and lowering operators (called ladder operators) are denoted by <span class="math notranslate nohighlight">\(\hat{a}\)</span>, and <span class="math notranslate nohighlight">\(\boldsymbol{\epsilon}\)</span> is the phonon mode eigenvector. With this expression the matrix elements can be written down, although the process is tedious, especially because the displacement operator is in the exponent of an exponential function. Therefore, we are applying a power series of these ladder operators, and keeping track of the indices in a code is not the easiest task. Fortunately, we can express these matrix elements with a series of convolution operations which account for all the index tracking automatically. This means that computationally we need only define a convolution operation and the objects to convolve.</p>
<p>We also implemented the possibility of anharmonic broadening to the dynamic structure factor. The equation at the top of the page is still correct because we generically defined <span class="math notranslate nohighlight">\(E_f\)</span> to be whatever we need it to be. However, since we are expressing the final states in terms of the harmonic phonons, <span class="math notranslate nohighlight">\(E_f\)</span> must take the form of a sum over the phonon energies that are in the multi-phonon state. For the 1-phonon final states that means <span class="math notranslate nohighlight">\(E_f\)</span> must be equal to a phonon energy/eigenvalue, meaning that the dynamic structure factor has delta functions at these energies. The anharmonic broadening is generally considered to be a weak perturbation, which allows us to approximate these delta functions as Lorentzian type functions of the form:</p>
<p><span class="math notranslate nohighlight">\(\delta(\omega - \omega_{sk}) \rightarrow \frac{1}{\pi} \frac{\Gamma_{sk}(\omega)}{(\omega - \omega_{sk})^2 + [\Gamma_{sk}(\omega)]^2}\)</span></p>
<p>in which <span class="math notranslate nohighlight">\(\Gamma(\omega)\)</span> is the imaginary part of the self-energy, which is a function of <span class="math notranslate nohighlight">\(\omega\)</span>. In the limiting case, that <span class="math notranslate nohighlight">\(\Gamma\)</span> is a constant, the above equation becomes exactly a Lorentzian distribution. However, when <span class="math notranslate nohighlight">\(\omega &gt;&gt; \omega_{sk}\)</span>, then the above distribution function no longer resembles a Lorentzian.</p>
<p>When the anharmonic and contact interactions are included in the calculation of <span class="math notranslate nohighlight">\(S(\textbf{q},\omega)\)</span>, then we obtain the multi-phonon dynamic structure factor, which is whole point of this code.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="contactinteraction.html" class="btn btn-neutral float-right" title="Theory: Contact Interactions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../usage/inputdirectives.html" class="btn btn-neutral float-left" title="Input Directives" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Thomas Harrelson.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>